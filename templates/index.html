<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OT Technical Glossary</title>
    <link href="{{ url_for('static', filename='css/main-font.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/bootstrap.min.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/sweetalert.min.css') }}" rel="stylesheet" type="text/css" >   
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet" type="text/css" > 
    <link href="{{ url_for('static', filename='css/orionicons.css') }}" rel="stylesheet" type="text/css">
    <!-- <link rel="shortcut icon" href="static/favicon.png"> -->
</head>

<body>
   <section id="navbar-section">
        <nav class="navbar navbar-expand-lg navbar-light">
            <a class="navbar-brand" href="#"><img src="{{ url_for('static', filename='images/ot-logo.png') }}">
                    </a>
            <div class="navbar-brand-title">
                Техникийн үг хэллэгийн 
                    хураангуй толь
            
            </div>
         
            
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                <a class="nav-link english" href="#top" >Glossary</a>
                <a class="nav-link mongolian" href="#top" >Хайлт хийх</a>
                </li>
                <li class="nav-item">
                <a class="nav-link english" href="#contribute-section">Contribute</a>
                <a class="nav-link mongolian" href="#contribute-section">Үг нэмэх</a>
                </li>
                <li class="nav-item">
                <a class="nav-link english" href="#subscription-section">Subscribe</a>
                <a class="nav-link mongolian" href="#subscription-section">И-мэйл бүртгүүлэх</a>
                </li>
                <li class="nav-item">
                <a class="nav-link english" href="#contact-section">Contact</a>
                <a class="nav-link mongolian" href="#contact-section">Холбоо барих</a>
                </li>
                <li class="nav-item">
                <a class="nav-link english" href="{{ url_for('proofread') }}" >Proofread</a>
                <a class="nav-link mongolian" href="{{ url_for('proofread') }}" >Хянах хэсэг</a>
                </li>
            </ul>
            </div>
        </nav> 
       
            
        
   </section>   
   
   <section id="search-section">
        <div class="background">
            <!-- <h1 class="background-title">Техникийн үг хэллэгийн хураангуй толь</h1> -->
        </div>
        <div class="searchbox-container">
            <div class="searchbox">
                <div class="inputcntr">
                     <input type="text" name="term" id="search" autocomplete="off" value="" size="50">
                     <a id="go-btn" onclick="get_words()"><i class="o-search-magnify-1 search-icon"></i></a>
                 </div>
                <div class="lang-menu">
                    <img src="{{ url_for('static', filename='images/british-flag.png') }}" class="eng-flag">
                    <img src="{{ url_for('static', filename='images/mng-flag.png') }}" class="mng-flag" style="display: none;">
                    <select id="lang" onchange="flag_toggle();">
                        <option>EN-MN</option>
                        <option>MN-EN</option>
                    </select>
                </div>
            </div>
                <div class="suggestions-autocomplete" style="overflow: scroll;" ></div>    
        </div>   
        <div class="container">
            <div class="row no-gutters">
                <div class="col-lg-8">
                    <div class="search-result-container">
                        <div class="intro-text">
                            <p>
                                Энэхүү Оюу Толгойн Техникийн үг хэллэгийн товч хураангуйг ашиглаж буй танд баярлалаа!
                                Тус толь бичигт гүний уурхай, барилга угсралт болон машин техниктэй холбогдолтой үг хэллэгийг багтаасан ба Оюу Толгойн бүх ажилчдад зориулав.
                            </p>
                            <p>Далайд дусал нэмэр.</p>
                            <hr>
                            <p>
                                Хэрэв та бидний ажилд туслан тус хураангуйд багтаагүй техникийн үг хэллэгийг нэмж ТОКЕН авахыг хүсвэл "Contribute" хэсэгт оруулна уу.
                            </p>
                        </div> 
                        <div class="search-result-box">
                            <div class="search-result" >
                                  <div class="search-result-show">
                                    <p id="searched-term"></p>
                                    <p id="searched-term-field"></p>
                                  </div>            
                                    <hr>
                                   <p id="searched-term-definition"></p>
                                   <p id="searched-term-description"></p>
                            </div> 
                        </div> 
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="searched-term-field-info">
                        <p>Энэ хураангуйд багтсан үгсийн орчуулгын хамаарах талбарууд:</p>
                        <ul class="english">
                            <li>Geo - Geology</li>
                            <li>M - Mining</li>
                            <li>C - Construction</li>
                            <li>T - Technical</li>
                            <li>G - General</li>
                        </ul>
                        <ul class="mongolian" style="display: none;">
                            <li>Geo - Геологийн</li>
                            <li>M - Уурхайн</li>
                            <li>C - Барилга угсралтын</li>
                            <li>T - Техникийн</li>
                            <li>G - Ерөнхий</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
   </section>

   <section id="contribute-section"> 
       <div class="container">
           <div class="row contributecntr no-gutters">
               <div class="col-lg-5">
                    <div class="addnew-info-container">
                        <h2>Contribute!</h2>
                        <p class="addnew-info">Та шинээр үг оруулахдаа тухайн үгийн ямар утгууд толь бичигт орсон байгааг (хэрэв энэ хэсэгт гарч ирсэн тохиолдолд) 
                        нягталж хараарай. Хэрэв таны оруулахыг хүссэн утга байвал өөр тайлбар эсвэл өөр шинэ үг оруулна уу.</p>
                            <div class="term-duplicate-check">
                                <div class="reminder-box">
                                    <h5>Санамж:</h5>
                                    <p class="reminder-text">Толь бичигт тухайн үг байгаа тул та өөр үг оруулна уу! 
                                        Хэрэв энэ санамж гарч ирэхгүй бол та тухайн үгээ илгээж болно. 
                                    </p>
                                    </div>
                                    <p id="existing-term"></p>
                                    <p id="existing-definition"></p>
                            </div>
                        <img src="{{ url_for('static', filename='svg/ot-token.svg') }}" id="ottoken">
                        <div class="token-info" style="display: none;" >
                            <h5>Үгс нэмж "ТОКЕН" цуглуулаарай!</h5>
                            <p>Lorem Ipsum is simply dummy text of the printing and 
                                typesetting industry. Lorem Ipsum has been the industry's 
                                standard dummy text ever since the 1500s, when an unknown 
                                printer took a galley of type and scrambled it to make a 
                                type specimen book. It has survived not only five centuries, 
                            </p>
                        </div>
                        <div class="token-info-btn">
                            <a>Урамшууллын талаар мэдээлэл<i class="o-trophy-1"></i></a>
                        </div>     
                    </div>
               </div>
               <div class="col-lg-7">
                    <div class="addnew-container">
                        <form class="addnew-form" role="form">
                            <h2>Шинэ үг нэмэх</h2>
                            <input id="new-term" name="new-term" class="term" required  placeholder="Оруулах үг" type="text"><br>
                            <input id="new-definition" name="new-definition" class="definition" required  placeholder="Үгийн утга" type="text"><br>
                            <textarea placeholder="Үгийн урт тайлбар /Хэрэв байгаа бол/" id="new-description" name="new-description" class="description" rows="3" cols="40"></textarea><br>
                            <label for="field-option">Таны оруулсан утгын хамаарах салбар:</label>
                            <select id="field-option" name="field-option">  
                                <option value="Geo">Geo</option>
                                <option value="M">M</option>
                                <option value="C">C</option>
                                <option value="T">T</option>
                                <option value="G">G</option>
                            </select><br>
                            <input type="email" id="submit-email" name="submit-email" placeholder="OT Имэйл хаяг" required ><br>
                            <input type="button" onclick="post_form()" name="submitbtn" value="Илгээх" class="submitbtn">
                        </form>
                    </div>
               </div>
           </div>
       </div>
   </section>
   
   <section id="subscription-section">
    <!-- <section class="subscription-container"> -->
 
     <div class="subscription-email-input">
         <h1 >Word a day?</h1>
         <p>Та өдөр бүр имэйлээр энэхүү хураангуйд багтсан үгсээс хүлээн авахыг хүсвэл доорх хэсэгт
             компанийн имэйл хаягаа үлдээгээрэй. 
            <!-- It is a long established fact that a reader will be distracted by the readable content of a 
            page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less 
            normal distribution of letters, as opposed to using 'Content here, content here', making it 
            look like readable English. Many desktop publishing packages and web page editors now use Lorem  -->
            
         </p>
        
        <input placeholder="Компанийн имэйл хаягаа үлдээнэ үү" type="email" class="subscription-input">
        <button class="subscription-input-btn">Илгээх</button>
       
         
     </div>
    </section>


<section id="contact-section">
    <!-- <div class="email-icon">
        <h1>Холбоо барих</h1>
        <img src="{{ url_for('static', filename='images/outlook.png') }}" class="img-fluid emailicon">
    </div> -->
    <div class="container text-center biggestcontainer">
        <!-- <h3 class="aboutus-title">About the resource</h3> -->
        <div class="row no-gutters bigcontainer">
            <div class="col-md-7 footer-container">
                <div class="aboutus-container">
                    <img src="{{ url_for('static', filename='images/khatantuul.png') }}">
                    <p class="aboutus-details"><b>Khatantuul.B</b><br>Front-end</p>
                    <p class="aboutus-text">Хураангуй толь гаргах ажлыг санаачлан, 
                        front-end хэсгийн хөгжүүлэлт болон дизайн дээр ажилласан.
                    </p>
                </div>
                <div class="aboutus-container">
                    <img src="{{ url_for('static', filename='images/erkhembayar.jpg') }}">
                    <p class="aboutus-details"><b>Erkhembayar.E</b><br>Back-end</p>
                    <p class="aboutus-text">Back-end талын хөгжүүлэлтийг хариуцан ажиллаж, дизайн болон ерөнхий бүтцэд туслан ажилласан. 
                    </p>
                   
                   
                </div>
            </div>
           
                <div class="col-md-5 footer-contact-container">
                    <p>Холбогдох линкүүд</p> 
                    <div class="footer-contact"> 
                        
                        <div class="emails">

                        <a href="mailto:yadamtsooz@ot.mn">ОТГУ-н Орчуулгийн багтай холбогдох</a> 
                
                        <a href="mailto:khatantuulb@ot.mn?cc=erkhembayare@ot.mn">Аппликэйшн ашиглалт/үгсийн сантай холбоотой асуудлаар</a> 
                

                        </div>
                        </div>
                </div>
           
           
        </div>
    </div>
</section>


</body>
</html>

<script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" ></script>
<script src="{{ url_for('static', filename='js/jquery-3.5.1.min.js') }}" ></script>
<script src="//code.jquery.com/ui/1.11.3/jquery-ui.js"></script>

<script src="{{ url_for('static', filename='js/sweetalert2.js') }}" ></script>
<script src="{{ url_for('static', filename='js/custom.js') }}" ></script>
<script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/smooth-scroll.js') }}"></script>
<script src="{{ url_for('static', filename='js/scroll-out.js') }}"></script>
<script type="text/javascript">

ScrollOut({
    targets: 'h1,p,input,button'
})


	

function post_form() {

        let new_term = $('#new-term').val()
        let new_definition = $("#new-definition").val();
        let new_description = $('#new-description').val()
        let field_option = $('#field-option option:selected').val()
        let email = $('#submit-email').val()

        let data = {'new-term': new_term,
                    'new-definition':new_definition,
                    'new-description': new_description,
                    'field-option':field_option,
                    'email': email
                }

                $.ajax({

                    type: 'POST',
                    url: '{{ config.ABS_PREFIX }}/contribute/addnew',
                    dataType: "json",
                    data: data,
                    success: function (response) {

                        alert(response.title,
                              response.response,
                              response.icon)
                    },
                    error: function (response) {
                                               
                        alert(response.responseJSON.title,
                              response.responseJSON.response,
                              response.responseJSON.icon)
                    },
                    complete: function (response) {
                        // $(".addnew-form").reset();
                        $(".addnew-form").each(function(){this.reset();
});
                    },
        }); 
        }

    const searchInput = document.querySelector('#search');
    const suggestionsPanel = document.querySelector('.suggestions-autocomplete');
    
    function populate(word){
        $.each(word, function (idx, w) {
            $('.suggestions-autocomplete').append(`<li class = element>${w}</li>`)

            
    })};
    
     $('body').on('click', '.suggestions-autocomplete > li', function(){
        $('.searchbox input').val($(this).text());
        get_words(); 
        $('.suggestions-autocomplete').slideUp('slow');

         
    });
    

    
        searchInput.addEventListener('keyup',function(e){
                var code = (e.keyCode || e.which);
                
                if(code == 38 || code == 40 || code == 13 || code == 64 || code == 9) {
                        return;
                    }
                // if (searchInput.value.length === 0){
                //     if(code == 8){
                //         return;
                //     }
                // }
                
                let search = $('#search').val();
                let lang = $(".lang-menu option:selected").text();
                let value=$.trim($("#search").val());

                let data = {'input_search': search,
                            'language':lang
                        }
            if(value.length > 0){
                $.ajax({
                    type: 'GET',
                    url: '{{ config.ABS_PREFIX }}/api/autocomplete',
                    dataType: "json",
                    data: data, 

                    success: function (response) {
                    let word = response.words
                    suggestionsPanel.innerHTML = '';

                    $('.intro-text').hide();
                    populate(word);
                    
                    $('.suggestions-autocomplete').addClass('open').slideDown('slow');               
                    $('.suggestions-autocomplete li:first').addClass('selected');
                    
                
            $('body').click(function(e){
            
                if(!$(e.target).is('input, a, li')){
                    $('.searchbox input').val('');
                    $('.suggestions-autocomplete').slideUp('slow');
                    $('.intro-text').show();
                    $('.search-result-box').hide();


                }

            });

            if ($('.suggestions-autocomplete').html() == ''){
                $('.suggestions-autocomplete').append('<a class="search_not_found">Энэ үг олдсонгүй. Хайсан үгээ бүтнээр бичин энд дарж бидэнд мэдэгдэнэ үү</a>')
                $('.search_not_found').click(function(){
                    add_not_found_to_db(search);
                    alert("Хүлээн авлаа", "Бид энэ үгийг удахгүй нэмнэ", "info");
                    $('.intro-text').show();
                    $('.search-result-box').hide();
                })
            }
            },
                error: function (response) {
                    console.log(response);
                    // alert(response)
                    alert(response.responseJSON.title,
                          response.responseJSON.response,
                          response.responseJSON.icon)
            },
                complete: function (response) {
                }
                });
            }else {
                $('.suggestions-autocomplete').slideUp('slow');   
                $('.intro-text').show();
                $('.search-result-box').hide();
            }
        })

    function add_not_found_to_db(not_found_word){
        $.post('{{ config.ABS_PREFIX }}/api/add_not_found_word/' + not_found_word, {'not_found_word':not_found_word});
    }


    function get_words() {
        let search = $('#search').val()
        let lang = $(".lang-menu option:selected").text();
        let data = {'input_search': search,
                    'language':lang
                }

                $.ajax({

                    type: 'GET',
                    url: '{{ config.ABS_PREFIX }}/main_search',
                    dataType: "json",
                    data: data,
                    success: function (response) {
                    
                        let word = response.words
                        $('.search-result-box').fadeIn(600);
                    
                        document.getElementById('searched-term').innerHTML = word['Term'];
                        document.getElementById('searched-term-definition').innerHTML = word['Definition'];
                        document.getElementById('searched-term-description').innerHTML = word['Description'];
                        document.getElementById('searched-term-field').innerHTML = word['Field'];
                        // $('.suggestions-autocomplete').slideUp('slow');
            
                    },
                    error: function (response) {
                        console.log(response)
                        // alert('Gahai')
                        alert(response.responseJSON.title,
                              response.responseJSON.response,
                              response.responseJSON.icon)
                    },
                    complete: function (response) {
                    },
        }); 
        }

    const searchInputcontribute = document.querySelector('#new-term');
        searchInputcontribute.addEventListener('keyup',function(e){
            let search = $('#new-term').val()
            var code = (e.keyCode || e.which);
            var query=$.trim($("#new-term").val());

            if(query.length > 0){
                $.ajax({

                    type: 'GET',
                    url: '{{ config.ABS_PREFIX }}/check/' + search,
                    
                    dataType: "json",

                    success: function (response) {
                    
                        let word = response.words
                        
                        if(word['Term'] == 0){
                            $('.addnew-info, #ottoken, .token-info-btn').show();
                            $('.term-duplicate-check').hide();
                        }else{
                            $('.addnew-info, #ottoken, .token-info-btn').hide();
                            $('.term-duplicate-check').show();
                            document.getElementById('existing-term').innerHTML = word['Term'];
                            document.getElementById('existing-definition').innerHTML = word['Definition'];
                        }               
                    
                    },
                    error: function (response) {
                        console.log(response)
                        // $('.reminder-text').html('lol');
                        alert(response.responseJSON.title,
                              response.responseJSON.response,
                              response.responseJSON.icon)
                    },
                    complete: function (response) {
                    },
                    }); 
                }else {
                    $('.term-duplicate-check').hide();
                    $('.addnew-info').show();
                }
                        })


    var scroll = new SmoothScroll('a[href*="#"]');


            $('#search').on('keyup', function(e){
                $('.suggestions-autocomplete').addClass('open');
                if (e.which == 40){
                    $('.element:not(:last-child).selected').removeClass('selected').next().addClass('selected');
                    $('#search').val($('.selected').text());
                } else if (e.which == 38) {
                    $('.element:not(:first-child).selected').removeClass('selected').prev().addClass('selected');
                    $('#search').val($('.selected').text());
                }
                $('.suggestions-autocomplete').scrollTop(230).scrollTop($('.selected').offset().top-$('.suggestions-autocomplete').height());

                if (e.which === 13) {
                            $('#go-btn').click();
                            $('.suggestions-autocomplete').slideUp('slow');  
                        }
            });

        $('.token-info-btn').click(function(){
            $('.addnew-info').hide();
            $('.token-info').show();
            $(this).hide();
            $('.token-info').append('<i class="o-exit-1 exit-icon"></i>');
            $('.exit-icon').click(function(){
                $('.addnew-info, .token-info-btn').show();
                $('.token-info, .exit-icon').hide();
            })
        })

</script>


